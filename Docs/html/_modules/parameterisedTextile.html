<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>parameterisedTextile &mdash; IAA 3D Weave Project  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> IAA 3D Weave Project
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">How to Install The Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">How To Use the Tool</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Module reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Code</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">IAA 3D Weave Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Module code</a> &raquo;</li>
      <li>parameterisedTextile</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for parameterisedTextile</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot; Module to generate a parameterised textile &quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">TexGen.Core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;c:</span><span class="se">\\</span><span class="s2">users</span><span class="se">\\</span><span class="s2">emxghs</span><span class="se">\\</span><span class="s2">desktop</span><span class="se">\\</span><span class="s2">IAA3DWeaveProject</span><span class="se">\\</span><span class="s2">parameterisedTextile</span><span class="se">\\</span><span class="s2">&quot;</span>

<span class="c1">#user specified properties</span>

<div class="viewcode-block" id="chunks"><a class="viewcode-back" href="../parameterisedTextile.html#parameterisedTextile.chunks">[docs]</a><span class="k">def</span> <span class="nf">chunks</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">),</span> <span class="n">n</span><span class="p">)]</span></div>


<div class="viewcode-block" id="GenerateTextile"><a class="viewcode-back" href="../parameterisedTextile.html#parameterisedTextile.GenerateTextile">[docs]</a><span class="k">def</span> <span class="nf">GenerateTextile</span><span class="p">(</span><span class="n">numXYarns</span><span class="p">,</span> <span class="n">numWefts</span><span class="p">,</span> <span class="n">warpSpacing</span><span class="p">,</span> <span class="n">weftSpacing</span><span class="p">,</span> <span class="n">warpHeight</span><span class="p">,</span> <span class="n">warpWidth</span><span class="p">,</span> <span class="n">weftHeight</span><span class="p">,</span> <span class="n">weftWidth</span><span class="p">,</span> <span class="n">binderHeight</span><span class="p">,</span> <span class="n">binderWidth</span><span class="p">,</span> <span class="n">warpRatio</span><span class="p">,</span> <span class="n">binderRatio</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">binderYarns</span><span class="p">,</span> <span class="n">numWeftLayers</span><span class="p">,</span> <span class="n">numWarpLayers</span><span class="p">,</span> <span class="n">numBinderLayers</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Function to generate a textile </span>

<span class="sd">    Args:</span>
<span class="sd">		numXYarns (int) : Total number of warp and binder yarns</span>
<span class="sd">		numWefts (int) : Total number of weft yarns</span>
<span class="sd">		warpSpacing (float) : Space between warp and binder yarns</span>
<span class="sd">		weftSpacing (float) : Space between weft yarns</span>
<span class="sd">		warpHeight (float) : Height of warp yarn</span>
<span class="sd">		warpWidth (float) : Width of warp yarn</span>
<span class="sd">		weftHeight (float) : Height of weft yarn</span>
<span class="sd">		weftWidth (float) : Width of weft yarn</span>
<span class="sd">		binderHeight (float) : Height of binder yarn</span>
<span class="sd">		binderWidth (float) : Width of binder yarn</span>
<span class="sd">		warpRatio (int) : Ratio of warp to binder yarns</span>
<span class="sd">		binderRatio (int) : Ratio of binder to warp</span>
<span class="sd">		length (float) : Length of unit cell</span>
<span class="sd">		width (float) : Width of unit cell</span>
<span class="sd">		height (float) : Height of unit cell</span>
<span class="sd">		binderYarns (list of ints) : Binder yarn offset positions</span>
<span class="sd">		numWeftLayers (int) : Number of weft layers</span>
<span class="sd">		numWarpLayers (int) : Number of warp layers</span>
<span class="sd">		numBinderLayers (int) : Number of binder layers</span>

<span class="sd">    Returns:</span>
<span class="sd">        Textile (CTextileDecoupledLToL): Textile object</span>
<span class="sd">		XVoxNum (int) : Number of voxels in x direction</span>
<span class="sd">		YVoxNum (int) : Number of voxels in y direction</span>
<span class="sd">		ZVoxNum (int) : Number of voxels in z direction </span>
<span class="sd">        </span>
<span class="sd">	&quot;&quot;&quot;</span>
	

	
	
	<span class="c1">#Set up 3D Weave textile</span>
	<span class="n">Textile</span> <span class="o">=</span> <span class="n">CTextileDecoupledLToL</span><span class="p">(</span> <span class="n">numXYarns</span><span class="p">,</span> <span class="n">numWefts</span><span class="p">,</span> <span class="n">warpSpacing</span><span class="p">,</span> <span class="n">weftSpacing</span><span class="p">,</span> <span class="n">warpHeight</span><span class="p">,</span> <span class="n">weftHeight</span><span class="p">,</span> <span class="n">numBinderLayers</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
	<span class="c1">#Textile = CTextileLayerToLayer( numXYarns, numWefts, warpSpacing, weftSpacing, warpHeight, weftHeight, numBinderLayers, True)</span>
	
	<span class="n">repeat</span> <span class="o">=</span> <span class="n">binderRatio</span> <span class="o">+</span> <span class="n">warpRatio</span>
	<span class="n">NumBinderYarns</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">numXYarns</span> <span class="o">*</span><span class="n">binderRatio</span><span class="p">)</span> <span class="o">/</span> <span class="n">repeat</span><span class="p">)</span>

	<span class="n">Textile</span><span class="o">.</span><span class="n">SetWarpRatio</span><span class="p">(</span><span class="n">warpRatio</span><span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetBinderRatio</span><span class="p">(</span><span class="n">binderRatio</span><span class="p">)</span>
	
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetupLayers</span><span class="p">(</span> <span class="n">numWarpLayers</span><span class="p">,</span> <span class="n">numWeftLayers</span><span class="p">,</span> <span class="n">numBinderLayers</span> <span class="p">)</span>
		
	<span class="c1">#Decompose binder yarn offsets into yarn lengths</span>
	<span class="n">binderYarns</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">binderYarns</span><span class="p">]</span>
	<span class="n">binderYarnLayers</span><span class="o">=</span><span class="n">chunks</span><span class="p">(</span><span class="n">binderYarns</span><span class="p">,</span> <span class="n">numWefts</span><span class="o">*</span><span class="n">numBinderLayers</span><span class="p">)</span>
		
	<span class="n">layerlist</span><span class="o">=</span><span class="p">[]</span>
	<span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">binderYarnLayers</span><span class="p">:</span>
		<span class="n">layerlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunks</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">numWefts</span><span class="p">))</span>
		
	<span class="n">binderYarns</span><span class="o">=</span><span class="n">layerlist</span>
		<span class="c1">#Check if length of binderYarns positions equal to numWefts</span>
	<span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NumBinderYarns</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">numBinderLayers</span> <span class="p">):</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">binderYarns</span><span class="p">[</span><span class="n">z</span><span class="p">][</span><span class="n">y</span><span class="p">])</span> <span class="o">!=</span> <span class="n">numWefts</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Too many binder yarn positions specified, must be equal to number of wefts.&quot;</span><span class="p">)</span>
	

	<span class="c1"># Loop for the number of binder yarn stacks</span>
	<span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NumBinderYarns</span><span class="p">):</span>
		<span class="c1"># Loop through the weft stacks</span>
		<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">numWefts</span> <span class="p">):</span>
			<span class="nb">list</span><span class="o">=</span><span class="p">[]</span>
			<span class="c1"># Loop through binder layers</span>
			<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">numBinderLayers</span><span class="p">):</span>
				<span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binderYarns</span><span class="p">[</span><span class="n">z</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
			<span class="c1"># Calculate the binder y position (ie warp yarn index)</span>
			<span class="n">ind</span> <span class="o">=</span> <span class="n">z</span><span class="o">/</span><span class="n">binderRatio</span>
			<span class="n">BinderIndex</span> <span class="o">=</span> <span class="n">warpRatio</span> <span class="o">+</span> <span class="p">(</span><span class="n">ind</span> <span class="o">*</span> <span class="n">repeat</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span><span class="o">%</span><span class="n">binderRatio</span>
			<span class="n">Textile</span><span class="o">.</span><span class="n">SetBinderPosition</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">BinderIndex</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
	
	
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetYYarnWidths</span><span class="p">(</span> <span class="n">weftWidth</span> <span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetXYarnWidths</span><span class="p">(</span> <span class="n">warpWidth</span> <span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetYYarnHeights</span><span class="p">(</span> <span class="n">weftHeight</span> <span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetXYarnHeights</span><span class="p">(</span> <span class="n">warpHeight</span> <span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetBinderYarnWidths</span><span class="p">(</span> <span class="n">binderWidth</span> <span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetBinderYarnHeights</span><span class="p">(</span> <span class="n">binderHeight</span> <span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetBinderYarnPower</span><span class="p">(</span> <span class="mf">0.2</span> <span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetWarpYarnPower</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetWeftYarnPower</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>

	<span class="n">WeftRepeat</span> <span class="o">=</span> <span class="kc">True</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetWeftRepeat</span><span class="p">(</span> <span class="n">WeftRepeat</span> <span class="p">)</span>
	
	<span class="n">Textile</span><span class="o">.</span><span class="n">BuildTextile</span><span class="p">()</span>
	
	<span class="n">Density</span> <span class="o">=</span> <span class="n">Textile</span><span class="o">.</span><span class="n">SetFibreDensity</span><span class="p">(</span><span class="n">WARP</span><span class="p">,</span> <span class="mi">1780</span><span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetFibreDensity</span><span class="p">(</span><span class="n">WEFT</span><span class="p">,</span> <span class="mi">1780</span><span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetFibreDensity</span><span class="p">(</span><span class="n">BINDER</span><span class="p">,</span> <span class="mi">1780</span><span class="p">)</span>
	

	<span class="c1">#George - remember to change this</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetFibresPerYarn</span><span class="p">(</span><span class="n">WARP</span><span class="p">,</span> <span class="mi">12000</span><span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetFibresPerYarn</span><span class="p">(</span><span class="n">WEFT</span><span class="p">,</span> <span class="mi">12000</span><span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetFibresPerYarn</span><span class="p">(</span><span class="n">BINDER</span><span class="p">,</span> <span class="mi">12000</span><span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetFibreDiameter</span><span class="p">(</span><span class="n">WARP</span><span class="p">,</span> <span class="mf">0.0026</span><span class="p">,</span> <span class="s2">&quot;mm&quot;</span><span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetFibreDiameter</span><span class="p">(</span><span class="n">WEFT</span><span class="p">,</span> <span class="mf">0.0026</span><span class="p">,</span> <span class="s2">&quot;mm&quot;</span><span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetFibreDiameter</span><span class="p">(</span><span class="n">BINDER</span><span class="p">,</span> <span class="mf">0.0026</span><span class="p">,</span> <span class="s2">&quot;mm&quot;</span><span class="p">)</span>
	
	<span class="c1"># Yarn material properties</span>
	<span class="n">Yarns</span><span class="o">=</span><span class="n">Textile</span><span class="o">.</span><span class="n">GetYarns</span><span class="p">()</span>
	<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Yarns</span><span class="p">)):</span>
		<span class="n">Yarns</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">SetYoungsModulusX</span><span class="p">(</span><span class="mf">174.4</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">)</span>
		<span class="n">Yarns</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">SetYoungsModulusY</span><span class="p">(</span><span class="mf">8.9</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">)</span>
		<span class="n">Yarns</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">SetYoungsModulusZ</span><span class="p">(</span><span class="mf">8.9</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">)</span>
		<span class="n">Yarns</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">SetShearModulusXY</span><span class="p">(</span><span class="mf">4.2</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">)</span>
		<span class="n">Yarns</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">SetShearModulusXZ</span><span class="p">(</span><span class="mf">4.2</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">)</span>
		<span class="n">Yarns</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">SetShearModulusYZ</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">)</span>
		<span class="n">Yarns</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">SetPoissonsRatioX</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
		<span class="n">Yarns</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">SetPoissonsRatioY</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
		<span class="n">Yarns</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">SetPoissonsRatioZ</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
		<span class="n">Yarns</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">SetAlphaX</span><span class="p">(</span><span class="mf">5.4</span><span class="p">)</span>
		<span class="n">Yarns</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">SetAlphaY</span><span class="p">(</span><span class="mf">5.4</span><span class="p">)</span>
		<span class="n">Yarns</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">SetAlphaZ</span><span class="p">(</span><span class="mf">5.4</span><span class="p">)</span>



	<span class="c1"># Matrix material properties</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetMatrixYoungsModulus</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="s1">&#39;GPa&#39;</span><span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetMatrixPoissonsRatio</span><span class="p">(</span><span class="mf">0.35</span><span class="p">)</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">SetMatrixAlpha</span><span class="p">(</span><span class="mf">52.7e-6</span><span class="p">)</span>
	
	<span class="n">ArealWeight</span> <span class="o">=</span> <span class="p">(</span><span class="n">Textile</span><span class="o">.</span><span class="n">GetYarnVolume</span><span class="p">()</span><span class="o">*</span><span class="mi">1780</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">length</span><span class="o">*</span><span class="n">width</span><span class="o">*</span><span class="n">height</span><span class="p">)</span>
	

	<span class="n">domain</span> <span class="o">=</span> <span class="n">CDomainPlanes</span><span class="p">(</span><span class="n">XYZ</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">binderHeight</span><span class="p">),</span> <span class="n">XYZ</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
	<span class="n">Textile</span><span class="o">.</span><span class="n">AssignDomain</span><span class="p">(</span> <span class="n">domain</span> <span class="p">)</span>
	<span class="n">AddTextile</span><span class="p">(</span> <span class="n">Textile</span> <span class="p">)</span>
	
	<span class="c1">#save TG model</span>
	<span class="c1"># print(&quot;Saving textile model&quot;)</span>
	<span class="n">voxelSize</span> <span class="o">=</span> <span class="mf">0.05</span>
	<span class="n">SaveToXML</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">emxghs</span><span class="se">\\</span><span class="s2">Desktop</span><span class="se">\\</span><span class="s2">IAA3DWeaveProject</span><span class="se">\\</span><span class="s2">parameterisedTextile</span><span class="se">\\</span><span class="s2">ptextile.tg3&quot;</span><span class="p">,</span> <span class="n">Textile</span><span class="o">.</span><span class="n">GetName</span><span class="p">(),</span> <span class="n">OUTPUT_STANDARD</span><span class="p">)</span>
	<span class="n">XVoxNum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">length</span> <span class="o">/</span> <span class="n">voxelSize</span><span class="p">)</span>
	<span class="n">YVoxNum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">width</span>  <span class="o">/</span> <span class="n">voxelSize</span><span class="p">)</span>
	<span class="n">ZVoxNum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">height</span> <span class="o">/</span> <span class="n">voxelSize</span><span class="p">)</span>
	<span class="n">numVoxels</span> <span class="o">=</span> <span class="n">XVoxNum</span> <span class="o">*</span> <span class="n">YVoxNum</span> <span class="o">*</span> <span class="n">ZVoxNum</span>
	
	<span class="c1"># #Get input file name</span>
	
	<span class="c1"># # Form the file name and open the file</span>
	<span class="c1"># input = </span>
	<span class="c1"># results_id = &quot;_&quot;.join([str(x) for x in input])</span>
	
	<span class="c1"># if numVoxels &lt; 100000:</span>
		<span class="c1"># Mesh = COctreeVoxelMesh(&quot;CPeriodicBoundaries&quot;)</span>
		<span class="c1"># #CTextile &amp;Textile, string OutputFilename, int XVoxNum, int YVoxNum, int ZVoxNum, int min_level, int refine_level, bool smoothing, int smoothIter, double smooth1, double smooth2, bool surfaceOuput</span>
		<span class="c1"># Mesh.SaveVoxelMesh(Textile, os.getcwd() + &quot;\\FileName&quot;, XVoxNum, YVoxNum, ZVoxNum, 1, 3, False, 0, 0, 0, False)</span>
	<span class="c1"># else:</span>
		<span class="c1"># Mesh = CRectangularVoxelMesh(&quot;CPeriodicBoundaries&quot;)</span>
		<span class="c1"># Mesh.SaveVoxelMesh(Textile, os.getcwd() + &quot;\\FileName&quot;, XVoxNum, YVoxNum, ZVoxNum, True, True, MATERIAL_CONTINUUM, 0 )</span>
	
	<span class="k">return</span> <span class="n">Textile</span><span class="p">,</span> <span class="n">XVoxNum</span><span class="p">,</span> <span class="n">YVoxNum</span><span class="p">,</span> <span class="n">ZVoxNum</span><span class="p">,</span> <span class="n">ArealWeight</span></div>
	
<div class="viewcode-block" id="SaveMesh"><a class="viewcode-back" href="../parameterisedTextile.html#parameterisedTextile.SaveMesh">[docs]</a><span class="k">def</span> <span class="nf">SaveMesh</span><span class="p">(</span><span class="n">Textile</span><span class="p">,</span> <span class="n">XVoxNum</span><span class="p">,</span> <span class="n">YVoxNum</span><span class="p">,</span> <span class="n">ZVoxNum</span><span class="p">,</span> <span class="nb">input</span><span class="p">):</span>
	
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Function to save mesh</span>
<span class="sd">	</span>
<span class="sd">	Args:</span>
<span class="sd">		Textile (CTextileDecoupledLToL): Textile object</span>
<span class="sd">		XVoxNum (int) : Number of voxels in x direction</span>
<span class="sd">		YVoxNum (int) : Number of voxels in y direction</span>
<span class="sd">		ZVoxNum (int) : Number of voxels in z direction</span>
<span class="sd">		input (list of ints) : Parameter list from optimisation algorithm</span>
<span class="sd">		</span>
<span class="sd">	Returns:</span>
<span class="sd">		None</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Save mesh&quot;</span><span class="p">)</span>
	
	<span class="n">numVoxels</span> <span class="o">=</span> <span class="n">XVoxNum</span> <span class="o">*</span> <span class="n">YVoxNum</span> <span class="o">*</span><span class="n">ZVoxNum</span>
	
		<span class="c1">#Get input file name</span>
	
	<span class="c1"># Form the file name and open the file</span>
	<span class="n">results_id</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">])</span>
	
	<span class="c1"># if numVoxels &lt; 100000:</span>
		<span class="c1"># print(&quot;saving octree mesh&quot;)</span>
		<span class="c1"># print(os.getcwd() + &quot;\\&quot; + &quot;optim_&quot; + results_id)</span>
		<span class="c1"># Mesh = COctreeVoxelMesh(&quot;CPeriodicBoundaries&quot;)</span>
		<span class="c1"># # CTextile &amp;Textile, string OutputFilename, int XVoxNum, int YVoxNum, int ZVoxNum, int min_level, int refine_level, bool smoothing, int smoothIter, double smooth1, double smooth2, bool surfaceOuput</span>
		<span class="c1"># Mesh.SaveVoxelMesh(Textile, os.getcwd() + &quot;\\&quot; + &quot;optim_&quot; + results_id, XVoxNum, YVoxNum, ZVoxNum, 1, 3, False, 0, 0, 0, False)</span>
	<span class="c1"># else:</span>
		<span class="c1"># print(&quot;saving rectangular mesh&quot;)</span>
	<span class="n">Mesh</span> <span class="o">=</span> <span class="n">CRectangularVoxelMesh</span><span class="p">(</span><span class="s2">&quot;CPeriodicBoundaries&quot;</span><span class="p">)</span>
	<span class="n">Mesh</span><span class="o">.</span><span class="n">SaveVoxelMesh</span><span class="p">(</span><span class="n">Textile</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;optim_&quot;</span> <span class="o">+</span> <span class="n">results_id</span><span class="p">,</span> <span class="n">XVoxNum</span><span class="p">,</span> <span class="n">YVoxNum</span><span class="p">,</span> <span class="n">ZVoxNum</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">MATERIAL_CONTINUUM</span><span class="p">,</span> <span class="mi">0</span> <span class="p">)</span>
	
	<span class="k">return</span></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
	<span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;c:</span><span class="se">\\</span><span class="s2">users</span><span class="se">\\</span><span class="s2">emxghs</span><span class="se">\\</span><span class="s2">desktop</span><span class="se">\\</span><span class="s2">IAA3DWeaveProject</span><span class="se">\\</span><span class="s2">parameterisedTextile</span><span class="se">\\</span><span class="s2">&quot;</span>
	<span class="c1">#print(sys.argv)</span>
	<span class="n">numXYarns</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
	<span class="n">numWefts</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
	<span class="n">warpSpacing</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
	<span class="n">weftSpacing</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
	<span class="n">warpHeight</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
	<span class="n">warpWidth</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
	<span class="n">weftHeight</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
	<span class="n">weftWidth</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
	<span class="n">binderHeight</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
	<span class="n">binderWidth</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>
	<span class="n">warpRatio</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span>
	<span class="n">binderRatio</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span>
	<span class="n">length</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">13</span><span class="p">])</span>
	<span class="n">width</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">14</span><span class="p">])</span>
	<span class="n">height</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">15</span><span class="p">])</span>
	<span class="n">numWeftLayers</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">16</span><span class="p">])</span>
	<span class="n">numWarpLayers</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">17</span><span class="p">])</span>
	<span class="n">numBinderLayers</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>
	<span class="nb">input</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">24</span><span class="p">]</span>
	


	<span class="n">file</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;binderpattern.dat&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
	<span class="n">allLines</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
	<span class="n">lastLine</span><span class="o">=</span><span class="n">allLines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
	<span class="n">x</span> <span class="o">=</span> <span class="n">lastLine</span>
	<span class="n">binderYarns</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
	<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

	<span class="n">Textile</span><span class="p">,</span> <span class="n">XVoxNum</span><span class="p">,</span> <span class="n">YVoxNum</span><span class="p">,</span> <span class="n">ZVoxNum</span><span class="p">,</span> <span class="n">ArealDensity</span> <span class="o">=</span> <span class="n">GenerateTextile</span><span class="p">(</span><span class="n">numXYarns</span><span class="p">,</span> <span class="n">numWefts</span><span class="p">,</span> <span class="n">warpSpacing</span><span class="p">,</span> <span class="n">weftSpacing</span><span class="p">,</span> <span class="n">warpHeight</span><span class="p">,</span> <span class="n">warpWidth</span><span class="p">,</span> <span class="n">weftHeight</span><span class="p">,</span> <span class="n">weftWidth</span><span class="p">,</span> <span class="n">binderHeight</span><span class="p">,</span> <span class="n">binderWidth</span><span class="p">,</span> <span class="n">warpRatio</span><span class="p">,</span> <span class="n">binderRatio</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">binderYarns</span><span class="p">,</span> <span class="n">numWeftLayers</span><span class="p">,</span> <span class="n">numWarpLayers</span><span class="p">,</span> <span class="n">numBinderLayers</span><span class="p">)</span>
	
	<span class="n">SaveMesh</span><span class="p">(</span><span class="n">Textile</span><span class="p">,</span> <span class="n">XVoxNum</span><span class="p">,</span> <span class="n">YVoxNum</span><span class="p">,</span> <span class="n">ZVoxNum</span><span class="p">,</span> <span class="nb">input</span><span class="p">)</span>
	
	<span class="c1">#Going to need to write this to a file</span>
	<span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;ArealDensity.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span>
	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ArealDensity</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
	<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Louise Brown, Mikhail Matveev, George Spackman.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>